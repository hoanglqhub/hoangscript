local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui", 5)

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CodeMenuVIP"
screenGui.IgnoreGuiInset = true
screenGui.Enabled = true
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local function createStroke(parent, thickness, color, transparency)
    local stroke = Instance.new("UIStroke")
    stroke.Thickness = thickness
    stroke.Color = color
    stroke.Transparency = transparency
    stroke.Parent = parent
    return stroke
end

local function createGradient(parent, colorSequence, rotation)
    local gradient = Instance.new("UIGradient")
    gradient.Color = colorSequence
    gradient.Rotation = rotation or 0
    gradient.Parent = parent
    return gradient
end

local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(0, 120, 0, 120)
loadingFrame.Position = UDim2.new(0.5, -60, 0.5, -60)
loadingFrame.BackgroundTransparency = 1
loadingFrame.Parent = screenGui

local loadingSpinner = Instance.new("ImageLabel")
loadingSpinner.Size = UDim2.new(0.8, 0, 0.8, 0)
loadingSpinner.Position = UDim2.new(0.1, 0, 0.1, 0)
loadingSpinner.Image = "rbxassetid://103930533102756"
loadingSpinner.BackgroundTransparency = 1
loadingSpinner.ImageTransparency = 0.3
loadingSpinner.Parent = loadingFrame

createGradient(loadingSpinner, ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 255, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 0, 255))
})

local welcomeLabel = Instance.new("TextLabel")
welcomeLabel.Size = UDim2.new(0, 250, 0, 40)
welcomeLabel.Position = UDim2.new(0.5, -125, 0.5, 40)
welcomeLabel.Text = "Welcome, " .. player.Name .. "!"
welcomeLabel.TextColor3 = Color3.fromRGB(255, 255, 150)
welcomeLabel.BackgroundTransparency = 1
welcomeLabel.TextSize = 20
welcomeLabel.Font = Enum.Font.GothamBold
welcomeLabel.TextTransparency = 1
welcomeLabel.Parent = loadingFrame

local welcomeStroke = createStroke(welcomeLabel, 2, Color3.fromRGB(0, 200, 255), 1)

local toggleButton = Instance.new("ImageButton")
toggleButton.Size = UDim2.new(0, 50, 0, 50)
toggleButton.Position = UDim2.new(0, 20, 0, 20)
toggleButton.Image = "rbxassetid://103930533102756"
toggleButton.BackgroundTransparency = 0.8
toggleButton.Visible = false
toggleButton.ZIndex = 10
toggleButton.Parent = screenGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 10)
toggleCorner.Parent = toggleButton

local toggleStroke = createStroke(toggleButton, 2, Color3.fromRGB(0, 255, 200), 0.5)

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 500, 0, 360)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -180)
mainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
mainFrame.BackgroundTransparency = 0.2
mainFrame.Visible = false
mainFrame.ClipsDescendants = true
mainFrame.ZIndex = 1
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 10)
mainCorner.Parent = mainFrame

createGradient(mainFrame, ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(50, 0, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 0, 150))
}, -45)

local menuBackground = Instance.new("ImageLabel")
menuBackground.Size = UDim2.new(1, 0, 1, 0)
menuBackground.Image = "rbxassetid://103930533102756"
menuBackground.ImageTransparency = 0.6
menuBackground.BackgroundTransparency = 1
menuBackground.ZIndex = 0
menuBackground.Parent = mainFrame

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, -20, 0, 30)
titleLabel.Position = UDim2.new(0, 10, 0, 10)
titleLabel.Text = "Code Menu VIP"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 150)
titleLabel.BackgroundTransparency = 1
titleLabel.TextSize = 24
titleLabel.Font = Enum.Font.GothamBlack
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.ZIndex = 2
titleLabel.Parent = mainFrame

createStroke(titleLabel, 2, Color3.fromRGB(0, 200, 255), 0.3)

local subtitleLabel = Instance.new("TextLabel")
subtitleLabel.Size = UDim2.new(1, -20, 0, 20)
subtitleLabel.Position = UDim2.new(0, 10, 0, 40)
subtitleLabel.Text = "T·ªïng h·ª£p c√°c game"
subtitleLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
subtitleLabel.BackgroundTransparency = 1
subtitleLabel.TextSize = 14
subtitleLabel.Font = Enum.Font.Gotham
subtitleLabel.TextXAlignment = Enum.TextXAlignment.Left
subtitleLabel.ZIndex = 2
subtitleLabel.Parent = mainFrame

local tabFrame = Instance.new("ScrollingFrame")
tabFrame.Size = UDim2.new(0, 157, 0, 250)
tabFrame.Position = UDim2.new(0, 10, 0, 70)
tabFrame.BackgroundTransparency = 1
tabFrame.ZIndex = 2
tabFrame.ScrollBarThickness = 4
tabFrame.ScrollBarImageColor3 = Color3.fromRGB(0, 255, 255)
tabFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
tabFrame.Parent = mainFrame

local tabListLayout = Instance.new("UIListLayout")
tabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
tabListLayout.Padding = UDim.new(0, 5)
tabListLayout.Parent = tabFrame

local function createTab(name, index)
    local contentFrame = Instance.new("ScrollingFrame")
    contentFrame.Size = UDim2.new(1, -177, 1, -120)
    contentFrame.Position = UDim2.new(0, 167, 0, 70)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Visible = (index == 1)
    contentFrame.ZIndex = 2
    contentFrame.ScrollBarThickness = 4
    contentFrame.ScrollBarImageColor3 = Color3.fromRGB(0, 255, 255)
    contentFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    contentFrame.Parent = mainFrame

    local listLayout = Instance.new("UIListLayout")
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Padding = UDim.new(0, 10)
    listLayout.Parent = contentFrame
    listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        contentFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y)
    end)

    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, -10, 0, 40)
    button.Text = name
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    button.BackgroundTransparency = 0.4
    button.Font = Enum.Font.GothamBold
    button.TextSize = 14
    button.ZIndex = 10
    button.Parent = tabFrame

    tabFrame.CanvasSize = UDim2.new(0, 0, 0, tabListLayout.AbsoluteContentSize.Y)

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = button

    local stroke = createStroke(button, 1.5, Color3.fromRGB(0, 255, 255), 0.6)

    local tweenInfo = TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut)
    button.MouseEnter:Connect(function()
        TweenService:Create(button, tweenInfo, {Size = UDim2.new(1, -10, 0, 44), BackgroundTransparency = 0.2}):Play()
        TweenService:Create(stroke, tweenInfo, {Transparency = 0.2}):Play()
    end)
    button.MouseLeave:Connect(function()
        TweenService:Create(button, tweenInfo, {Size = UDim2.new(1, -10, 0, 40), BackgroundTransparency = 0.4}):Play()
        TweenService:Create(stroke, tweenInfo, {Transparency = 0.6}):Play()
    end)

    button.MouseButton1Click:Connect(function()
        print("Tab clicked: " .. name)
        for _, content in ipairs(mainFrame:GetChildren()) do
            if content:IsA("ScrollingFrame") and content ~= tabFrame then
                content.Visible = (content == contentFrame)
            end
        end
        button.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
        for _, otherButton in ipairs(tabFrame:GetChildren()) do
            if otherButton:IsA("TextButton") and otherButton ~= button then
                otherButton.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
            end
        end
    end)

    return contentFrame
end

local function createParagraph(contentFrame, title, content)
    local paragraphFrame = Instance.new("Frame")
    paragraphFrame.Size = UDim2.new(1, -10, 0, 100)
    paragraphFrame.BackgroundTransparency = 1
    paragraphFrame.ZIndex = 2
    paragraphFrame.Parent = contentFrame

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, 0, 0, 20)
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 150)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextSize = 16
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.ZIndex = 2
    titleLabel.Parent = paragraphFrame

    local contentLabel = Instance.new("TextLabel")
    contentLabel.Size = UDim2.new(1, 0, 0, 70)
    contentLabel.Position = UDim2.new(0, 0, 0, 25)
    contentLabel.Text = content
    contentLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    contentLabel.BackgroundTransparency = 1
    contentLabel.TextSize = 14
    contentLabel.Font = Enum.Font.Gotham
    contentLabel.TextXAlignment = Enum.TextXAlignment.Left
    contentLabel.TextWrapped = true
    contentLabel.ZIndex = 2
    contentLabel.Parent = paragraphFrame
end

local function createButton(contentFrame, title, description, callback)
    local buttonFrame = Instance.new("Frame")
    buttonFrame.Size = UDim2.new(1, -10, 0, 60)
    buttonFrame.BackgroundTransparency = 1
    buttonFrame.ZIndex = 2
    buttonFrame.Parent = contentFrame

    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, 0, 0, 40)
    button.Text = title
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    button.BackgroundTransparency = 0.4
    button.Font = Enum.Font.GothamBold
    button.TextSize = 14
    button.ZIndex = 10
    button.Parent = buttonFrame

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = button

    local stroke = createStroke(button, 1.5, Color3.fromRGB(0, 255, 255), 0.6)

    local descLabel = Instance.new("TextLabel")
    descLabel.Size = UDim2.new(1, 0, 0, 20)
    descLabel.Position = UDim2.new(0, 0, 0, 40)
    descLabel.Text = description
    descLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    descLabel.BackgroundTransparency = 1
    descLabel.TextSize = 12
    descLabel.Font = Enum.Font.Gotham
    descLabel.TextXAlignment = Enum.TextXAlignment.Left
    descLabel.ZIndex = 2
    descLabel.Parent = buttonFrame

    local tweenInfo = TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut)
    button.MouseEnter:Connect(function()
        TweenService:Create(button, tweenInfo, {Size = UDim2.new(1, 0, 0, 44), BackgroundTransparency = 0.2}):Play()
        TweenService:Create(stroke, tweenInfo, {Transparency = 0.2}):Play()
    end)
    button.MouseLeave:Connect(function()
        TweenService:Create(button, tweenInfo, {Size = UDim2.new(1, 0, 0, 40), BackgroundTransparency = 0.4}):Play()
        TweenService:Create(stroke, tweenInfo, {Transparency = 0.6}):Play()
    end)

    button.MouseButton1Click:Connect(function()
        print("Button clicked: " .. title)
        local success, err = pcall(callback)
        if not success then
            warn("Error in " .. title .. ": " .. tostring(err))
        end
    end)
end

local guideTab = createTab("H∆∞·ªõng D·∫´n", 1)
createParagraph(guideTab, "H∆∞·ªõng D·∫´n Th√™m Ch·ª©c NƒÉng", [[
Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi Code Menu VIP! D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt ƒë·ªÉ th√™m ch·ª©c nƒÉng v√†o menu:

1. Th√™m ƒëo·∫°n vƒÉn (paragraph):
   - H√†m: createParagraph(contentFrame, title, content)
   - Tham s·ªë:
     + contentFrame: guideTab (ho·∫∑c tab m·ªõi b·∫°n t·∫°o).
     + title: Ti√™u ƒë·ªÅ ƒëo·∫°n vƒÉn (chu·ªói, v√≠ d·ª•: "Th√¥ng tin").
     + content: N·ªôi dung ƒëo·∫°n vƒÉn (chu·ªói, h·ªó tr·ª£ xu·ªëng d√≤ng).
   - V√≠ d·ª•:
     createParagraph(guideTab, "Th√¥ng tin Menu", "ƒê√¢y l√† menu h·ªó tr·ª£ nhi·ªÅu game Roblox.")
   - L∆∞u √Ω: M·ªói paragraph cao 100px, t·ª± ƒë·ªông cu·ªôn n·∫øu n·ªôi dung d√†i.

2. Th√™m n√∫t (button):
   - H√†m: createButton(contentFrame, title, description, callback)
   - Tham s·ªë:
     + contentFrame: guideTab (ho·∫∑c tab m·ªõi).
     + title: T√™n n√∫t (chu·ªói, v√≠ d·ª•: "TƒÉng T·ªëc").
     + description: M√¥ t·∫£ n√∫t (chu·ªói, hi·ªÉn th·ªã d∆∞·ªõi n√∫t).
     + callback: H√†m ch·∫°y khi nh·∫•n n√∫t (function).
   - V√≠ d·ª• tƒÉng t·ªëc ƒë·ªô nh√¢n v·∫≠t:
     createButton(guideTab, "TƒÉng T·ªëc", "TƒÉng t·ªëc ƒë·ªô ch·∫°y", function()
         print("TƒÉng t·ªëc ƒë∆∞·ª£c k√≠ch ho·∫°t!")
         if game.Players.LocalPlayer.Character then
             game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 50
         end
     end)
   - V√≠ d·ª• teleport ƒë·∫øn v·ªã tr√≠:
     createButton(guideTab, "Teleport", "Di chuy·ªÉn ƒë·∫øn t·ªça ƒë·ªô (100, 50, 100)", function()
         print("Teleporting...")
         if game.Players.LocalPlayer.Character then
             game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(100, 50, 100)
         end
     end)
   - L∆∞u √Ω: Ki·ªÉm tra game.Players.LocalPlayer.Character t·ªìn t·∫°i ƒë·ªÉ tr√°nh l·ªói.

3. Th√™m n√∫t v·ªõi loadstring:
   - H√†m: T∆∞∆°ng t·ª± createButton, nh∆∞ng callback d√πng loadstring.
   - V√≠ d·ª•:
     createButton(guideTab, "Script Blox Fruits", "Ch·∫°y script kh√¥ng c·∫ßn key", function()
         print("ƒêang t·∫£i script...")
         repeat wait() until game:IsLoaded()
         local success, err = pcall(function()
             loadstring(game:HttpGet("https://example.com/script.lua"))()
         end)
         if not success then
             warn("L·ªói loadstring: " .. err)
         end
     end)
   - L∆∞u √Ω:
     + Ki·ªÉm tra URL h·ª£p l·ªá (m·ªü tr√™n tr√¨nh duy·ªát) tr∆∞·ªõc khi d√πng.
     + D√πng repeat wait() until game:IsLoaded() ƒë·ªÉ ƒë·∫£m b·∫£o game s·∫µn s√†ng.
     + Loadstring c√≥ r·ªßi ro b·∫£o m·∫≠t, ki·ªÉm tra k·ªπ script v√† ngu·ªìn.
     + C√≥ th·ªÉ vi ph·∫°m Roblox ToS, s·ª≠ d·ª•ng c·∫©n th·∫≠n.

4. Th√™m tab m·ªõi:
   - H√†m: createTab(name, index)
   - Tham s·ªë:
     + name: T√™n tab (chu·ªói, v√≠ d·ª•: "Script M·ªõi").
     + index: Th·ª© t·ª± tab (s·ªë, v√≠ d·ª•: 2, 3, ...).
   - V√≠ d·ª•:
     local newTab = createTab("Script M·ªõi", 2)
     createParagraph(newTab, "Th√¥ng tin", "Tab m·ªõi cho script.")
     createButton(newTab, "Ch·∫°y Script", "T·∫£i script game", function()
         print("Ch·∫°y script m·ªõi")
         repeat wait() until game:IsLoaded()
         loadstring(game:HttpGet("https://example.com/new.lua"))()
     end)
   - L∆∞u √Ω: tabFrame c√≥ ScrollingFrame, h·ªó tr·ª£ nhi·ªÅu tab (t·ª± ƒë·ªông cu·ªôn n·∫øu v∆∞·ª£t 250px).

5. Debug v√† t·ªëi ∆∞u:
   - Ki·ªÉm tra l·ªói:
     + Xem Output trong Roblox Studio:
       - "Tab clicked: [name]" khi chuy·ªÉn tab.
       - "Button clicked: [title]" khi nh·∫•n n√∫t.
       - "Error in [title]: [error]" n·∫øu n√∫t l·ªói.
     + N·∫øu loadstring th·∫•t b·∫°i, ki·ªÉm tra URL (HTTP 404, 403,...) ho·∫∑c Roblox ch·∫∑n HttpGet.
   - Giao di·ªán tr√†n:
     + contentFrame c√≥ ScrollingFrame, t·ª± ƒë·ªông cu·ªôn n·∫øu n·ªôi dung v∆∞·ª£t 240px.
     + TƒÉng mainFrame.Size (v√≠ d·ª•: UDim2.new(0, 600, 0, 400)) n·∫øu c·∫ßn th√™m kh√¥ng gian.
     + Gi·∫£m TextSize c·ªßa paragraph/button (v√≠ d·ª•: 12 thay v√¨ 14) n·∫øu ch·ªØ qu√° to.
   - T·ªëi ∆∞u:
     + Th√™m wait() ho·∫∑c ki·ªÉm tra ƒëi·ªÅu ki·ªán (nh∆∞ game:IsLoaded()) tr∆∞·ªõc khi ch·∫°y logic.
     + D√πng pcall ƒë·ªÉ b·ªçc callback, tr√°nh l·ªói ph√° h·ªßy menu.
     + Test tr√™n PC v√† mobile ƒë·ªÉ ƒë·∫£m b·∫£o giao di·ªán m∆∞·ª£t.

6. L∆∞u √Ω quan tr·ªçng:
   - Loadstring t·ª´ URL kh√¥ng an to√†n, c√≥ th·ªÉ ch·ª©a m√£ ƒë·ªôc ho·∫∑c vi ph·∫°m Roblox ToS.
   - Ki·ªÉm tra script k·ªπ tr∆∞·ªõc khi d√πng, ∆∞u ti√™n nh√∫ng code ng·∫Øn n·∫øu c√≥ th·ªÉ.
   - N·∫øu th√™m nhi·ªÅu n·ªôi dung, ƒë·∫£m b·∫£o index c·ªßa tab kh√¥ng tr√πng (2, 3, 4,...).
   - Li√™n h·ªá nh√† ph√°t tri·ªÉn menu n·∫øu c·∫ßn h·ªó tr·ª£ th√™m ho·∫∑c b√°o l·ªói.

H√£y th·ª≠ th√™m n·ªôi dung v√†o guideTab ho·∫∑c t·∫°o tab m·ªõi theo v√≠ d·ª• tr√™n. Ch√∫c b·∫°n t·∫°o menu tuy·ªát v·ªùi! üòé
]])

local function makeDraggable(frame)
    local dragging, dragInput, dragStart, startPos
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            local connection
            connection = input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                    connection:Disconnect()
                end
            end)
        end
    end)
    local dragConnection
    dragConnection = UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            dragInput = input
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    frame.AncestryChanged:Connect(function()
        if not frame:IsDescendantOf(game) then
            dragConnection:Disconnect()
        end
    end)
end

makeDraggable(mainFrame)
makeDraggable(toggleButton)

local tweenInfo = TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut)
toggleButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
    TweenService:Create(mainFrame, tweenInfo, {BackgroundTransparency = mainFrame.Visible and 0.2 or 1, Size = mainFrame.Visible and UDim2.new(0, 500, 0, 360) or UDim2.new(0, 450, 0, 320)}):Play()
end)

toggleButton.MouseEnter:Connect(function()
    TweenService:Create(toggleButton, tweenInfo, {ImageTransparency = 0.2}):Play()
    TweenService:Create(toggleStroke, tweenInfo, {Transparency = 0.2}):Play()
end)
toggleButton.MouseLeave:Connect(function()
    TweenService:Create(toggleButton, tweenInfo, {ImageTransparency = 0}):Play()
    TweenService:Create(toggleStroke, tweenInfo, {Transparency = 0.5}):Play()
end)

local function runWelcomeAnimation()
    if not playerGui then
        warn("Error: PlayerGui not found!")
        return
    end

    local spinnerTween = TweenService:Create(loadingSpinner, TweenInfo.new(1.2, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1), {Rotation = 360})
    spinnerTween:Play()

    local welcomeTweenInfo = TweenInfo.new(1.2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
    local welcomeTween = TweenService:Create(welcomeLabel, welcomeTweenInfo, {TextTransparency = 0, Size = UDim2.new(0, 270, 0, 48)})
    local welcomeStrokeTween = TweenService:Create(welcomeStroke, welcomeTweenInfo, {Transparency = 0})
    welcomeTween:Play()
    welcomeStrokeTween:Play()

    task.wait(2)
    local fadeOutTweenInfo = TweenInfo.new(0.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
    local fadeOut = TweenService:Create(loadingFrame, fadeOutTweenInfo, {BackgroundTransparency = 1})
    local spinnerFade = TweenService:Create(loadingSpinner, fadeOutTweenInfo, {ImageTransparency = 1})
    local welcomeFade = TweenService:Create(welcomeLabel, fadeOutTweenInfo, {TextTransparency = 1})
    local welcomeStrokeFade = TweenService:Create(welcomeStroke, fadeOutTweenInfo, {Transparency = 1})
    fadeOut:Play()
    spinnerFade:Play()
    welcomeFade:Play()
    welcomeStrokeFade:Play()
    fadeOut.Completed:Connect(function()
        spinnerTween:Cancel()
        loadingFrame:Destroy()
        toggleButton.Visible = true
    end)
end

if playerGui then
    local ancestryConnection
    ancestryConnection = screenGui.AncestryChanged:Connect(function()
        if not screenGui:IsDescendantOf(game) then
            ancestryConnection:Disconnect()
        end
    end)
    task.spawn(runWelcomeAnimation)
else
    warn("Error: PlayerGui not found!")
end
